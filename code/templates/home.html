<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Graphify</title>
    <link rel="icon" href="{{ url_for('static', filename='logo_nobg.png') }}" type="image/png">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="header-container">
        <img src="{{ url_for('static', filename='logo_nobg.png') }}" alt="Graphify Logo" style="width: 75px; height: auto;">
        <h1>Graphify</h1>

    </div>

    <! PAPARAZZI >
    <div class="search-container">
        <form method="POST">
            <label for="artist_name">Enter Artist Name:</label>
            <input type="text" id="artist_name" name="artist_name" required>
            <div class="button-container">
                <button type="submit">Search</button>
            </div>
        </form>
        <! SLAP THE APPY >
        <form action="/refresh" method="post" style="margin-top: 20px;">
            <button type="submit">Clear</button>
        </form>
    </div>



    <! FOUNTAIN PEN >

<!-- {# Manual Control - OBSOLETE #}
{#<form action="/set_font" method="post">#}
{#    <label for="font">Choose a font:</label>#}
{#    <select name="font" id="font">#}
{#        <option value="general" {% if current_font == 'general' %}selected{% endif %}>Default (Unicode)</option>#}
{#        <option value="chinese" {% if current_font == 'chinese' %}selected{% endif %}>Chinese (Noto Sans SC)</option>#}
{#        <option value="japanese" {% if current_font == 'japanese' %}selected{% endif %}>Japanese (Noto Sans JP)</option>#}
{#        <option value="korean" {% if current_font == 'korean' %}selected{% endif %}>Korean (Noto Sans KR)</option>#}
{#    </select>#}
{#    <button type="submit">Apply Font</button>#}
{#</form>#} -->

    <!-- {% if current_font %}
        <p><strong>Current Font:</strong> {{ current_font }}</p>
    {% endif %} -->


    <hr>

    {% if artist %}
        <div class="artist-info">
            <h1>{{ artist["name"] }}</h1>
            <h2>Popularity: {{ artist["popularity"] }}</h2>
            {% if artist["genres"] %}
                <h2>Genres: {{ artist["genres"] | map('title') | join(", ") }}</h2>
            {% endif %}
        </div>
        {% if "error" in artist %}
            <p>{{ artist["error"] }}</p>
        {% else %}
        <div class="album-container">
            <h3>Top Albums:</h3>
            <ul class="album-list">
                {% for album in albums %}
                    <li>
                        <strong>{{ album["name"] }}</strong>
                        <br>
                        <img src="{{ album['image'] }}" alt="Album Cover" width="100">
                    </li>
                {% endfor %}
             </ul>
        </div>
    
        <div class="track-container">
            <h3>Top Tracks:</h3>
            <ol class="track-list">
                {% for track in tracks %}
                    <li>
                        <strong>{{ track["name"] }}</strong> (Popularity: {{ track["popularity"] }})
                        <br>
                        Album: {{ track["album_name"] }}
                        <br>
                        <img src="{{ track["album_image"] }}" alt="Album Cover" width="100">
                        <br>
                        <a href="{{ track["track_url"] }}" target="_blank">Listen on Spotify</a>
                        {% if track["preview_url"] %}
                            <br>
                            <audio controls>
                                <source src="{{ track["preview_url"] }}" type="audio/mpeg">
                                Your browser does not support the audio element.
                            </audio>
                        {% endif %}
                    </li>
                {% endfor %}
            </ol>
        </div>
        {% if track_analysis %}
        <div class="analysis-container">
            <h3>Popularity Analysis</h3>

                <h4>Average: {{ track_analysis["average_popularity"] }}</h4>
                <h4>Max: {{ track_analysis["max_popularity"] }}</h4>
                <h4>Min: {{ track_analysis["min_popularity"] }}</h4>
        </div>
    {% endif %}
        
        {% endif %}
    {% endif %}
    {% if plot_path %}
    <h3>Track Popularity Visualization:</h3>
    <img src="{{ plot_path }}" alt="Track Popularity Bar Chart" width="600">
    {% endif %}
</body>
</html>