<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spotify Artist Analysis</title>
</head>
<body>
    <h1>Spotify Artist Analysis</h1>

    <form method="POST">
        <label for="artist_name">Enter Artist Name:</label>
        <input type="text" id="artist_name" name="artist_name" required>
        <button type="submit">Search</button>
    </form>

    {% if artist %}
        <h2>Artist: {{ artist["name"] }}</h2>
        {% if "error" in artist %}
            <p>{{ artist["error"] }}</p>
        {% else %}
        <h3>Top Albums:</h3>
        <ul>
            {% for album in albums %}
                <li>
                    <strong>{{ album["name"] }}</strong>
                    <br>
                    <img src="{{ album['image'] }}" alt="Album Cover" width="100">
                </li>
            {% endfor %}
        </ul>

            <h3>Top Tracks:</h3>
            <ul>
                {% for track in tracks %}
                    <li>
                        <strong>{{ track["name"] }}</strong> (Popularity: {{ track["popularity"] }})
                        <br>
                        Album: {{ track["album_name"] }}
                        <br>
                        <img src="{{ track["album_image"] }}" alt="Album Cover" width="100">
                        <br>
                        <a href="{{ track["track_url"] }}" target="_blank">Listen on Spotify</a>
                        {% if track["preview_url"] %}
                            <br>
                            <audio controls>
                                <source src="{{ track["preview_url"] }}" type="audio/mpeg">
                                Your browser does not support the audio element.
                            </audio>
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>

            {% if track_analysis %}
                <h3>Track Analysis:</h3>
                <ul>
                    <li>Average Popularity: {{ track_analysis["average_popularity"] }}</li>
                    <li>Max Popularity: {{ track_analysis["max_popularity"] }}</li>
                    <li>Min Popularity: {{ track_analysis["min_popularity"] }}</li>
                </ul>
            {% endif %}
        {% endif %}
    {% endif %}
    {% if plot_path %}
    <h3>Track Popularity Visualization:</h3>
    <img src="{{ plot_path }}" alt="Track Popularity Bar Chart" width="600">
    {% endif %}
</body>
</html>